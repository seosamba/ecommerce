<?php !$this->headTitle() && $this->headTitle($this->translate('Manage products')); ?>

<?php
    $this->headScript()
            ->appendFile($this->websiteUrl . 'system/js/external/chosen/chosen.jquery.min.js')
            ->appendFile($this->websiteUrl . 'plugins/shopping/web/js/libs/accounting.min.js')
			->appendFile($this->websiteUrl.'plugins/shopping/web/js/libs/require.min.js', null, array('data-main' => $this->websiteUrl.'plugins/shopping/web/js/modules/store-products/config'));

	$this->headLink()
			->appendStylesheet($this->websiteUrl . 'system/js/external/chosen/chosen.css');
?>
<div id="store-products" class="toaster-widget store-widget">
    <input type="hidden" name="system-language" value="<?php echo Tools_Misc::getJsTranslationLanguage();?>"/>
    <input type="hidden" name="system-currency" value="<?php echo $this->currency->getSymbol() ;?>"/>
    <input type="hidden" name="product-limit" value="<?php echo $this->productLimitFlag ;?>"/>
    <div class="search-line clearfix">
        <input type="text" class="pfilter grid_3 alpha mb20px" name="productsearch" placeholder="<?php echo $this->translate('search by name, sku, mpn') ?>" >
        <div class="grid_9 omega">
            <div class="grid_3 alpha ">
                <select class="pfilter" multiple name="filter-brand" data-placeholder="<?php echo $this->translate('Filter by brand..');?>">
                    <?php foreach($this->brands as $brand):?>
                        <option value="<?php echo $brand->getName();?>"><?php echo $brand->getName();?></option>
                    <?php endforeach;?>
                </select>
            </div>
            <div class="grid_2 alpha omega ">
                <select class="pfilter" multiple name="filter-tag" data-placeholder="<?php echo $this->translate('Filter by tag..');?>">
                    <?php foreach($this->tags as $tag):?>
                        <option value="<?php echo $tag->getId();?>"><?php echo $tag->getName();?></option>
                    <?php endforeach;?>
                </select>
            </div>
            <?php
            $grid = 'grid_4';
            if($this->productLimitFlag){
                $grid = 'grid_2';
            }
            ?>
            <div class="<?php echo $grid;?> omega ">
                <select class="pfilter" multiple name="filter-inventory" data-placeholder="<?php echo $this->translate('Filter by inventory..');?>">
                    <option value="<?php echo '&infin;';?>"><?php echo '&infin;';?></option>
                    <?php foreach($this->inventory as $qty):?>
                        <option value="<?php echo $qty;?>"><?php echo $qty;?></option>
                    <?php endforeach;?>
                </select>
            </div>
            <?php if($this->productLimitFlag):?>
                <div class="<?php echo $grid;?> omega ">
                    <select class="pfilter" multiple name="filter-limit" data-placeholder="<?php echo $this->translate('Filter by threshold values..');?>">
                        <?php foreach($this->productLimit as $limit):?>
                            <option value="<?php echo $limit;?>"><?php echo $limit;?></option>
                        <?php endforeach;?>
                    </select>
                </div>
                <label class="pfilterLimit grid_3">
                    <input class="pfilter find-by-limit" type="checkbox" name="find-by-limit"><span> <?php echo $this->translate('Show only low stock products');?><span>
                </label>
            <?php endif;?>
        </div>
    </div>
	<table class="products-table widget omega">
		<thead>
			<tr>
				<th><input type="checkbox" name="check-all" title="<?php echo $this->translate('Select all');?>"></th>
				<th><?php echo $this->translate('Name');?></th>
				<th><?php echo $this->translate('Brand');?></th>
				<th><?php echo $this->translate('Sku');?></th>
				<th><?php echo $this->translate('Mpn');?></th>
                <th><?php echo $this->translate('Free shipping');?></th>
				<th><?php echo $this->translate('Weight');?></th>
                <th><?php echo $this->translate('Inventory');?></th>

                <?php if(!empty($this->productLimitFlag)):?>
                <th><?php echo $this->translate('Alert threshold');?></th>
                <?php endif;?>

				<th><?php echo $this->translate('Price');?></th>
                <th><?php echo $this->translate('Sales count');?></th>
			</tr>
		</thead>
        <?php
        $colspan = 10;
        if(!empty($this->productLimitFlag)){
            $colspan++;
        }
        ?>
		<tbody>
			<tr>
				<td colspan="<?php echo $colspan;?>" class="text-center">
					<img src="<?php echo $this->websiteUrl;?>system/images/spinner-small.gif" alt="Loading..." />
				</td>
			</tr>
		</tbody>
		<tfoot>
			<tr>
				<td colspan="<?php echo $colspan;?>">
                    <div class="grid_3 alpha">
                        <?php echo $this->translate('with selected');?>:&nbsp;
                        <select name="product-mass-action" id="">
                            <option value="0"><?php echo $this->translate('select mass action');?></option>
                            <option value="brand"><?php echo $this->translate('assign brand');?></option>
                            <option value="template"><?php echo $this->translate('assign page template');?></option>
                            <option value="tax"><?php echo $this->translate('assign tax');?></option>
                            <option value="freeshipping"><?php echo $this->translate('assign free shipping');?></option>
                            <option value="tag"><?php echo $this->translate('assign/remove tag');?></option>
                            <option value="delete"><?php echo $this->translate('delete (nonreversible)');?></option>
                            <option value="toggle"><?php echo $this->translate('enable/disable');?></option>
                            <?php if($this->productLimitFlag):?>
                            <option value="productLimit"><?php echo $this->translate('assign product limit');?></option>
                            <?php endif;?>
                        </select>
                    </div>
                    <div id="paginator" class="paginator text-right grid_9 omega mt10px"></div>
				</td>
			</tr>
		</tfoot>
	</table>
</div>